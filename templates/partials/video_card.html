{% load humanize %}

<div class="col">
    <div class="card video-card h-100">
        <div class="video-thumbnail">
            <img src="{{ video.thumbnail_url|default:'https://via.placeholder.com/320x180?text=No+Thumbnail' }}" 
                 alt="{{ video.title }}" class="card-img-top">
            
            {% if video.is_live %}
                <div class="live-badge">LIVE</div>
                <div class="viewer-count">
                    <i class="bi bi-eye-fill me-1"></i>{{ video.viewer_count|floatformat:0 }}
                </div>
            {% else %}
                <div class="video-duration">{{ video.duration_formatted|default:"00:00" }}</div>
            {% endif %}
        </div>
        
        <div class="card-body p-3">
            <h6 class="card-title mb-2">
                <a href="{% if video.is_live %}{% url 'streaming:watch' video.stream_id %}{% else %}{% url 'content:watch' video.id %}{% endif %}" 
                   class="text-decoration-none text-dark">
                    {{ video.title|truncatechars:60 }}
                </a>
            </h6>
            
            <div class="d-flex align-items-center mb-2">
                <img src="{% if video.uploader.avatar %}{{ video.uploader.avatar.url }}{% else %}https://via.placeholder.com/24x24?text={{ video.uploader.username|first }}{% endif %}" 
                     class="rounded-circle me-2" width="24" height="24" alt="{{ video.uploader.username }}">
                <small class="text-muted">{{ video.uploader.username }}</small>
            </div>
            
            <div class="text-muted small">
                {% if video.is_live %}
                    <i class="bi bi-eye me-1"></i>{{ video.viewer_count|floatformat:0 }}人視聴中
                {% else %}
                    <i class="bi bi-eye me-1"></i>{{ video.view_count|intcomma }}回視聴
                    <span class="mx-2">•</span>
                    <i class="bi bi-clock me-1"></i>{{ video.created_at|timesince }}前
                {% endif %}
            </div>
            
            {% if video.category %}
                <div class="mt-2">
                    <span class="badge" style="background-color: {{ video.category.color }}">
                        {{ video.category.name }}
                    </span>
                </div>
            {% endif %}
        </div>
    </div>
</div>